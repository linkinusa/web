define("common:widget/banner_swipe/banner_swipe.js",function(t,n,e){e.exports=function(t,n){"use strict";function e(t){var n=p.children.length;for(t%=n;n--;)p.children[n].className=n===t?"active":""}function i(){v=t.children,b=v.length,n.continuous&&3>b&&(t.appendChild(v[0].cloneNode(!0)),t.appendChild(t.children[1].cloneNode(!0)),v=t.children,b=v.length,g=!0),f=new Array(b),m=t.getBoundingClientRect().width||t.offsetWidth;for(var e=b;e--;){var i=v[e];i.setAttribute("data-index",e),c(e,w>e?-m:e>w?m:0,0)}n.continuous&&(0===w&&c(r(w-1),-m,0),w===b&&c(r(w+1),m,0)),t.style.visibility="visible"}function o(){n.continuous?s(w-1):w&&s(w-1)}function a(){n.continuous?s(w+1):w<v.length-1&&s(w+1)}function r(t){return(v.length+t%v.length)%v.length}function s(t,i){if(w!=t){var o=Math.abs(w-t)/(w-t);if(n.continuous){var a=o;o=-f[r(t)]/m,o!==a&&(t=-o*v.length+t)}for(var s=Math.abs(w-t)-1;s--;)c(r((t>w?t:w)-s-1),m*o,0);t=r(t),c(w,m*o,i||y),c(t,0,i||y),n.continuous&&c(r(t-o),-(m*o),0),w=t,e(w),x(n.callback&&n.callback(w,v[w]))}}function c(t,n,e){u(t,n,e),f[t]=n}function u(t,n,e){var i=v[t],o=i&&i.style;o&&(o.webkitTransitionDuration=o.transitionDuration=e+"ms",o.webkitTransform="translate("+n+"px,0)translateZ(0)",o.transform="translateX("+n+"px)")}function d(){E=setTimeout(a,k)}function l(){k=0,clearTimeout(E)}if(n=n||{},t&&t.nodeType&&0!==t.children.length){var h={touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(t){var n=["transitionProperty","WebkitTransition"];for(var e in n)if(void 0!==t.style[n[e]])return!0;return!1}(document.createElement("swipe"))};if(!h.touch||!h.transitions||1===t.children.length)return t.style.visibility="visible",void 0;var v,f,m,b,p,x=function(t){setTimeout(t,0)},g=!1,w=parseInt(n.startSlide,10)||0,y=n.speed||300;n.continuous=void 0!==n.continuous?n.continuous:!0,function(){if(n.addPointers){var e=t.children.length,i=e,o=10*e-4;for(p=document.getElementById("j-pointers"),p.style.width=o+"px",p.style.marginLeft=0-o/2+"px";i--;){var a=document.createElement("i");e-i-1===w&&(a.className="active"),p.appendChild(a)}}}();var E,k=n.auto||0;i(),k&&d();var T,L,D={},M={};return L={handleEvent:function(t){switch(t.type){case"touchstart":this.start(t);break;case"touchmove":this.move(t);break;case"touchend":x(this.end(t));break;case"resize":x(i.call());break;case"webkitTransitionEnd":case"transitionend":x(this.transitionEnd(event))}},start:function(n){var e=n.touches[0];D={x:e.pageX,y:e.pageY,time:+new Date},T=void 0,M={},t.addEventListener("touchmove",this,!1),t.addEventListener("touchend",this,!1)},move:function(t){if(!(t.touches.length>1||t.scale&&1!==t.scale)){var e=t.touches[0];M={x:e.pageX-D.x,y:e.pageY-D.y},"undefined"==typeof T&&(T=!!(T||Math.abs(M.x)<Math.abs(M.y))),T||(t.preventDefault(),l(),n.continuous?(u(r(w-1),M.x+f[r(w-1)],0),u(w,M.x+f[w],0),u(r(w+1),M.x+f[r(w+1)],0)):(M.x=M.x/(!w&&M.x>0||w==v.length-1&&M.x<0?Math.abs(M.x)/m+1:1),u(w-1,M.x+f[w-1],0),u(w,M.x+f[w],0),u(w+1,M.x+f[w+1],0)))}},end:function(){var i=+new Date-D.time,o=Number(i)<250&&Math.abs(M.x)>20||Math.abs(M.x)>m/2,a=!w&&M.x>0||w==v.length-1&&M.x<0;n.continuous&&(a=!1);var s=M.x<0;T||(o&&!a?(s?(n.continuous?(c(r(w-1),-m,0),c(r(w+2),m,0)):c(w-1,-m,0),c(w,f[w]-m,y),c(r(w+1),f[r(w+1)]-m,y),w=r(w+1)):(n.continuous?(c(r(w+1),m,0),c(r(w-2),-m,0)):c(w+1,m,0),c(w,f[w]+m,y),c(r(w-1),f[r(w-1)]+m,y),w=r(w-1)),e(w),n.callback&&n.callback(w,v[w])):n.continuous?(c(r(w-1),-m,y),c(w,0,y),c(r(w+1),m,y)):(c(w-1,-m,y),c(w,0,y),c(w+1,m,y))),t.removeEventListener("touchmove",L,!1),t.removeEventListener("touchend",L,!1)},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)==w&&(n.auto&&(clearTimeout(E),E=setTimeout(a,n.auto)),n.transitionEnd&&n.transitionEnd.call(event,w,v[w]))}},t.addEventListener("touchstart",L,!1),window.addEventListener("resize",L,!1),t.addEventListener("webkitTransitionEnd",L,!1),t.addEventListener("transitionend",L,!1),{next:function(){l(),a()},prev:function(){l(),o()},slide:function(t,n){l(),s(t,n)},pos:function(){return w},len:function(){return g?2:v.length}}}}});
;define("common:widget/ui/dialog/dialog.js",function(t,e,n){var o=function(){function t(t){return/^-?[\d\.]+$/.test(t)?t+"px":t}function e(t,e){var n,o;for(n=0,o=t.length;o>n;++n)e(t[n],n)}return function(n){function o(t){t=t||window.event,t.target||(t.target=t.srcElement,t.preventDefault=function(){this.returnValue=!1});var e,o,i=t.target.id;i&&"ui-dialog-"===i.substr(0,10)&&(i=i.substr(10),"__"===i.substr(i.length-2)?(i=i.substr(0,i.length-2),e=n["on"+i.charAt(0).toUpperCase()+i.substr(1)],"mask"===i&&(o=n.clickOnMaskClose?!0:!1)):e=u[i]?u[i].handler:!1,"undefined"==typeof o&&"function"==typeof e&&(o=e()),o!==!1&&g())}var i,d,a,s=document.createElement("div"),l=s.style;s.className="ui-dialog",n=n||{},n.context=n.context&&1===n.context.nodeType?n.context:document.body,n.maskContext=n.maskContext&&1===n.maskContext.nodeType?n.maskContext:document.body,n.mask="undefined"==typeof n.mask?!0:!!n.mask,n.showCloseBtn="undefined"==typeof n.showCloseBtn?!0:!!n.showCloseBtn;var c,r=n.content&&n.content.parentNode?n.content.parentNode:!1,u=n.buttons||{},p=[];for(c in u)p.push('<button id="ui-dialog-'+c+'" class="ui-dialog-button">'+u[c].label+"</button>");if(s.innerHTML='<div class="ui-dialog-wrap">'+(n.hideHeader?"":'<div class="ui-dialog-header"><div class="ui-dialog-title">'+(n.title||"")+"</div>"+(n.showCloseBtn?'<div id="ui-dialog-close__" class="ui-dialog-close"></div>':"")+"</div>")+'<div class="ui-dialog-body">'+(r?"":n.content.outerHTML?n.content.outerHTML:'<p class="ui-dialog-txt">'+n.content+"</p>")+'</div><div class="ui-dialog-footer">'+p.join("")+"</div></div>",n.context.appendChild(s),r&&s.childNodes[0].childNodes[1].appendChild(n.content),e(["width","height"],function(e){n[e]&&(l[e]=t(n[e]))}),d=s.clientHeight,a=s.clientWidth,l.display="none","object"==typeof n.position){var v=n.position;l.position="absolute",e(["top","left","right","bottom"],function(e){v[e]&&(l[e]=t(v[e]))})}else l.position="fixed",l.marginTop=t(0-d/2),l.marginLeft=t(0-a/2),l.top="50%",l.left="50%";l.display="block",n.mask&&(i=document.createElement("div"),i.className="ui-dialog-mask",i.id="ui-dialog-mask__",n.maskContext.appendChild(i));var f=function(t,e,n){t&&(t.removeEventListener?t.removeEventListener(e,n,!0):t.detachEvent("on"+e,n),t.parentNode&&t.parentNode.removeChild(t))},m=function(t,e,n){t&&(t.addEventListener?t.addEventListener(e,n,!0):t.attachEvent("on"+e,n))},g=function(){r&&r.appendChild(n.content),f(i,"click",o),f(s,"click",o)};return m(s,"click",o),m(i,"click",o),{destory:g,target:s,mask:i}}}();n.exports=o});
;define("common:widget/ui/http/http.js",function(e,n,o){function t(e,n){void 0===e&&(e=window.location.search.substring(1));for(var o=e.split("&"),t={},r=0,i=o.length;i>r;r++){var c,s=o[r].split("="),a=n?s[0]:decodeURIComponent(s[0]);(c=s[1])&&(c=n?c:decodeURIComponent(c).replace(/\+/g," "),void 0===t[a]?t[a]=c:("object"!=typeof t[a]&&(t[a]=[t[a]]),t[a].push(c)))}return t}function r(e,n){var o,t,r=[];for(o in e)if(t=e[o],o=n?o:encodeURIComponent(o),t)if("object"!=typeof t)r.push(o+"="+(n?t:encodeURIComponent(t)));else for(var i=0,c=t.length;c>i;i++)t[i]&&r.push(o+"="+(n?t[i]:encodeURIComponent(t[i])));return r.join("&").replace(/\%20/g,"+")}var i=function(e,n){var o,t={};for(o in e)t[o]=e[o];for(o in n)t[o]=n[o];return t},c=function(e,n){void 0===n&&(n=e,e=window.location.search.substring(1)),"string"==typeof e&&(e=t(e)),"string"==typeof n&&(n=t(n));var o=i(e,n);return r(o)},s=function(e,n){1===arguments.length&&(n=e,e=window.location.search.substring(1));var o=t(e);for(var i in o)switch(typeof n){case"string":i===n&&(o[i]="");break;case"object":n.indexOf&&n.indexOf(i)>=0&&(o[i]="");break;case"function":n(o[i],i)===!0&&(o[i]="")}return r(o)};o.exports={create:c,parse:t,reject:s}});
;define("common:widget/ui/lazyload/lazyload.js",function(t){function i(){var t=window.scrollY,i=t+window.innerHeight;return[t,i]}function n(t,i){function n(){function n(){i.apply(o,e)}var o=this,e=[].slice.call(arguments);a&&clearTimeout(a),a=setTimeout(n,t)}var a;return n._zid=i._zid=i._zid||o.proxy(i)._zid,n}var o=t("common:widget/lib/gmu/zepto/zepto.js"),a=o(window);o.fn.lazyload=function(t){function n(){var n=i();l=n[0],d=n[1],t.supportAsync&&(s=o(c)),s=o(o.map(s,function(i){return i.lazyload||!o(i).data(t.dataAttribute)?null:i})),s.each(e)}function e(){var i=this,n=o(this);if(!i.lazyload){var a=n.data(t.dataAttribute),e=t.threshold,r=n.offset(),s=r.top-e,c=r.top+r.height+e;if(s>=l&&d>=s||c>=l&&d>=c||l>=s&&c>=d)n.attr("src",a).css("visibility","hidden"),i.lazyload="loading",i.onload=function(){i.lazyload="loaded",n.css("visibility","visible")};else if(s>d)return!1}}var r={threshold:0,dataAttribute:"src",supportAsync:!1};t=o.extend({},r,t),a.on("scrollStop orientationchange",n);var l,d,s=this,c=this.selector;o(document).ready(function(){n()}),/iphone|ipad/gi.test(navigator.appVersion)&&a.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&n()})},o(window).on("scroll",n(80,function(){o(window).trigger("scrollStop")}))});
;define("common:widget/ui/map_convert/map_convert.js",function(e,t,a){function n(e,t,a){return i([e/Math.pow(2,a-18),t/Math.pow(2,a-18)])}function r(e,t,a){var n=o([e,t]),r=n[0]*Math.pow(2,a-18),i=n[1]*Math.pow(2,a-18);return[Math.ceil(r),Math.ceil(i)]}function o(e){var t,a;e[0]=u(e[0],-180,180),e[1]=c(e[1],-74,74),t=e.slice(0);for(var n=0;n<x.length;n++)if(t[1]>=x[n]){a=b[n];break}if(!a)for(n=x.length-1;n>=0;n--)if(t[1]<=-x[n]){a=b[n];break}var r=f(e,a);return e=[r[0].toFixed(2),r[1].toFixed(2)]}function i(e){var t,a;t=[Math.abs(e[0]),Math.abs(e[1])];for(var n=0;n<h.length;n++)if(t[1]>=h[n]){a=l[n];break}var r=f(e,a);return e=[r[0].toFixed(6),r[1].toFixed(6)]}function f(e,t){if(e&&t){var a=t[0]+t[1]*Math.abs(e[0]),n=Math.abs(e[1])/t[9],r=t[2]+t[3]*n+t[4]*n*n+t[5]*n*n*n+t[6]*n*n*n*n+t[7]*n*n*n*n*n+t[8]*n*n*n*n*n*n;return a*=e[0]<0?-1:1,r*=e[1]<0?-1:1,[a,r]}}function c(e,t,a){return null!=t&&(e=Math.max(e,t)),null!=a&&(e=Math.min(e,a)),e}function u(e,t,a){for(;e>a;)e-=a-t;for(;t>e;)e+=a-t;return e}var h=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],x=[75,60,45,30,15,0],l=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],b=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];a.exports={pixelToLngLat:n,lngLatToPixel:r}});
;define("common:widget/ui/map_geolocation/map_geolocation.js",function(t){function i(){this._defaultOptions={enableHighAccuracy:!1,timeout:1e4,maximumAge:0,retry:!0,cookieFirst:!0,usePositionIn30Min:!0},this._retryTimes=0,this._isAndroid=!!/android/i.test(navigator.userAgent),this._error={}}function o(){this._isApnAvailable=!1,this._isApnTimeout=!1,this._isNativeGeoSuc=!1,this._isNativeAvailable=!1,this._isNativeTimeout=!1,this._config={host:"127.0.0.1"}}function e(){}function r(){this._config={domain:".baidu.com",path:"/",webCookieKey:"H_LOC_MI",nativeCookieKey:"H_LOC_APP",expires:18e5},this._isShareLocSuc=!1}function n(){}function s(t,i){i=i||{};for(var o in i)t[o]=i[o];return t}function c(t,i){var o=document.createElement("script"),e=Math.floor(1e4*Math.random()),r="_cbk"+e;if(window[r]=function(t){i(t)},-1==t.indexOf("callback=")){var n="&callback="+r;-1==t.indexOf("=")&&(n=n.slice(1)),t+=n}o.src=t,o.addEventListener("load",function(t){var i=t.target;i.parentNode.removeChild(i),delete window[r]},!1),document.getElementsByTagName("head")[0].appendChild(o)}function a(t,i){window.baidu&&window.baidu._callback||(window.baidu=window.baidu||{},window.baidu._callback=function(t){b.trigger("addresssuccess",{result:t})}),c("http://loc.map.baidu.com/wloc?x="+i+"&y="+t+"&r=41&prod=geoapi&addr=city|district|street|city_code&fn=_callback&t="+(new Date).getTime())}function d(t){return m.get(t)}function u(t,i,o){m.set(t,i,o)}function p(t){var i=t.addressComponent,o=t.address,e=t.coords.x,r=t.coords.y,n=_.pixelToLngLat(e,r,18);return{crd:e+"_"+r+"_"+n[0]+"_"+n[1]+"_"+(t.coords&&t.coords.accuracy),cc:i.cityCode,addr:o,tp:"gl",city:i.city,district:i.district,street:i.street,t:t.timestamp}}function g(t,i,o){this.coords=t,t.x&&(t.x=parseFloat(t.x)),t.y&&(t.y=parseFloat(t.y)),this.timestamp=i,this.addressComponent=o||{city:"",district:"",street:""},this.address=this.addressComponent.city+this.addressComponent.district+this.addressComponent.street}function l(){this._handlers={}}var _=t("common:widget/ui/map_convert/map_convert.js"),f=t("common:widget/ui/usertrack/usertrack.js"),m=t("common:widget/ui/cookie/cookie.js");i.prototype.getCurrentPosition=function(t,i,o){this._timestamp=+new Date,this._successCallback=t,this._errorCallback=i,this._currentOptions=s(this._defaultOptions,o),this._bind(),b.trigger("start")},i.prototype._bind=function(){if(!this._binded){this._binded=!0;var t=this,i=t._currentOptions;b.on("start",function(){y.getPosition(5)}),b.on("lightAppsuccess",function(i){t._position=new g(i.position.coords,i.position.timestamp),a(i.position.coords.latitude,i.position.coords.longitude)}),b.on("lightAppfail",function(o){return t._error.lightAppError=o.error,i.cookieFirst&&t._isAndroid?(h.getPosition(),void 0):(w.getPosition(i),void 0)}),b.on("nativesuccess",function(i){t._position=i.position,y.setPosition(p(t._position)),b.trigger("success")}),b.on("nativefail",function(o){t._error.nativeError=o.error,w.getPosition(i)}),b.on("cookiesuccess",function(i){t._position=i.position,b.trigger("success")}),b.on("cookiefail",function(o){t._error.cookieError=o.error,5==o.error.minutes?v.getPosition():30==o.error.minutes&&(i.retry&&t._retryTimes<1?(t._retryTimes++,b.trigger("start")):b.trigger("fail"))}),b.on("html5success",function(i){t._position=new g(i.position.coords,i.position.timestamp),a(i.position.coords.latitude,i.position.coords.longitude)}),b.on("html5fail",function(i){t._error.html5Error=i.error,y.getPosition(30)}),b.on("addresssuccess",function(i){var o=i.result,e=o.addr,r=_.pixelToLngLat(o.point.x,o.point.y,18);t._position.coords={x:o.point.x,y:o.point.y,accuracy:t._position.coords.accuracy,longitude:r[0],latitude:r[1]},t._position.addressComponent.city=e.city,t._position.addressComponent.cityCode=e.city_code,t._position.addressComponent.district=e.district,t._position.addressComponent.street=e.street,t._position.address=e.city+e.district+e.street,y.setPosition(p(t._position)),b.trigger("success")}),b.on("success",function(){t._successCallback&&t._successCallback(t._position)}),b.on("fail",function(){var i=(new Date).getTime()-t._timestamp;t._error.html5Error&&f.send("action=locate&type=failure&reason=html5&code="+t._error.html5Error.code+"&time="+i),t._errorCallback&&t._errorCallback(t._error)})}},window.geolocation=new i,o.prototype.getPosition=function(){var t=this,i=function(i){if(clearTimeout(t._apnTimer),t._isApnTimeout===!1){if(i&&0==i.error)return t._isNativeAvailable=!0,t._getPosition(),void 0;b.trigger("nativefail",{error:{code:-2}})}};c("http://"+this._config.host+":6259/getapn?",i),t.checkApnTimeout(2)},o.prototype.checkApnTimeout=function(t){var i=this;i._apnTimer=setTimeout(function(){i._isNativeAvailable===!1&&(i._isApnTimeout=!0,b.trigger("nativefail",{error:{code:6}}))},1e3*t)},o.prototype._getPosition=function(){var t=this,i=function(i){clearTimeout(t._nativeGeoTimer),t._isNativeTimeout===!1&&(i&&0==i.error?t.getDetailLoc(i):i&&i.error>0?b.trigger("nativefail",{error:{code:i.error}}):b.trigger("nativefail",{error:{code:-1}}))};c("http://"+this._config.host+":6259/geolocation?timeout=10000",i),t.checkNativeTimeout(10)},o.prototype.checkNativeTimeout=function(t){var i=this;i._nativeGeoTimer=setTimeout(function(){i._isNativeGeoSuc===!1&&(i._isNativeTimeout=!0,b.trigger("nativefail",{error:{code:3}}))},1e3*t)},o.prototype.getDetailLoc=function(t){var i=this,o=i.getRgcUrl(t),e=function(o){var e=o.content,r=e&&e.address_detail,n=e&&e.point,s=_.pixelToLngLat(n.x,n.y,18);i._isNativeGeoSuc=!0;var c=new g({x:n.x,y:n.y,accuracy:t.coords.accuracy,longitude:s[0],latitude:s[1]},Date.now(),{city:r.city,district:r.district,street:r.street,cityCode:r.city_code||1});b.trigger("nativesuccess",{position:c})};c(o,e)},o.prototype.getRgcUrl=function(t){var i=t.coords.longitude,o=t.coords.latitude;return"http://api.map.baidu.com/?qt=rgc&x="+i+"&y="+o+"&dis_poi=100&poi_num=10&ie=utf-8&oue=1&res=api"};var h=new o;e.CODE_NOT_SUPPORTED=-2,e.CODE_UNKNOWN=-1,e.CODE_PERMISSION_DENIED=1,e.CODE_UNAVAILABLE=2,e.CODE_TIMEOUT=3,e.prototype.getPosition=function(){var t=!1;return window.clouda&&clouda.device&&clouda.device.geolocation&&(t=!0),t?(clouda.device.geolocation.get({onsuccess:function(t){var i={position:{coords:t,timestamp:+new Date}};b.trigger("lightAppsuccess",i)},onfail:function(t){b.trigger("lightAppfail",{error:{code:t}})}}),void 0):(b.trigger("lightAppfail",{error:{code:e.CODE_NOT_SUPPORTED}}),void 0)};var v=new e;r.prototype._getCookie=function(t){if(t&&("web"==t||"native"==t)){var i="web"===t?this._config.webCookieKey:this._config.nativeCookieKey,o=d(i);if(o){var e=JSON.parse(o);if(o&&e){if(e.crd){var r=e.crd.split("_");r.length>4&&(e.crd={x:r[0],y:r[1],longitude:r[2],latitude:r[3],r:r[4]})}return e}}}},r.prototype.setPosition=function(t){var i=JSON.stringify(t);u(this._config.webCookieKey,i,{path:this._config.path,expires:this._config.expires})},r.prototype.getPosition=function(t){var i,o;this._minutes=parseInt(t,10),o=this._getCookie("native")||this._getCookie("web")||!1,o!==!1?i=this.getPreciseLoc(o):b.trigger("cookiefail",{error:{minutes:t}})},r.prototype._getPositionObject=function(t){var i=t.crd;if(i){var o=new g({x:i.x,y:i.y,accuracy:i.r,longitude:i.longitude,latitude:i.latitude},parseInt(t.t,10),{city:t.city,district:t.district,street:t.street,cityCode:t.cc});return o}},r.prototype.getPreciseLoc=function(t){var i=Date.now()-6e4*this._minutes,o=this._getPositionObject(t);o.coords.x&&o.timestamp>i?b.trigger("cookiesuccess",{position:o}):b.trigger("cookiefail",{error:{minutes:this._minutes}})};var y=new r;n.prototype.getPosition=function(t){if(!navigator.geolocation)return b.trigger("html5fail",{error:{code:4}}),void 0;var i={};t=t||{},t.timeout!=Math.Infinity&&(i.timeout=t.timeout),i.enableHighAccuracy=t.enableHighAccuracy,i.maximumAge=t.maximumAge,navigator.geolocation.getCurrentPosition(function(t){b.trigger("html5success",{position:t})},function(t){b.trigger("html5fail",{error:t})},i)};var w=new n;l.prototype.on=function(t,i){this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i)},l.prototype.trigger=function(t,i){if(this._handlers[t])for(var o=0;o<this._handlers[t].length;o++)this._handlers[t][o](i)};var b=new l});
;define("common:widget/ui/storage/storage.js",function(t,e,r){r.exports=function(){function t(t){try{return JSON.parse(t)}catch(e){return t}}var e=window.localStorage,r=function(){try{return e.setItem("t","t"),!0}catch(t){return!1}}(),n="__val",o="__exp",i=function(t,i,a){if(r){if("string"!=typeof i&&"object"!=typeof i)throw new Error("`"+i+"` is not the valid value, only support String or Object");if("number"==typeof a){var u={};u[n]=i,u[o]=+Date.now()+1e3*a*3600*24;try{e.setItem(t,JSON.stringify(u))}catch(c){alert(c)}}else e.setItem(t,"object"==typeof i?JSON.stringify(i):i);return i}},a=function(i){if(r){var a=t(e.getItem(i));return a&&"object"==typeof a&&a.hasOwnProperty(o)?a[o]>+Date.now()?a[n]:(u(i),null):a}},u=function(t){r&&e.removeItem(t)},c=function(){r&&e.clear()},f=function(){if(r){for(var t={},n=[],o=0,i=e.length;i>o;o++)n.push(e.key(o));for(o=0,i=n.length;i>o;o++){var u=n[o],c=a(u);null!==c&&(t[u]=c)}return t}},l=function(){r&&f()};return l(),{available:r,setItem:i,getItem:a,removeItem:u,clear:c,getAll:f,cleanup:l}}()});
;define("common:widget/ui/suggestion/suggestion.js",function(t,e,i){function r(t,e,i){var r="",s="",o={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},n="";r+="<ul class='ui-sug-hotbrand'>";for(var a=0,c=t.length;c>a;a++)s="item"+Math.round(4*Math.random()),r+="<li class="+s+">"+t[a]+"</li>";for(r+="</ul>",r+="<div class='ui-sug-line'></div>",r+="<ul class='ui-sug-history'>",a=0,c=e.length;c>a;a++)n=e[a].replace(/[<>&"']/g,function(t){return o[t]}),r+="<li>"+n+"</li>";r+="</ul>",r+=["<ul class='ui-sug-btns'>","<li class='ui-sug-clear'>清除历史记录</li>","<li class='ui-sug-close-small'>关闭</li>","</ul>"].join(""),i.html(r)}function s(t){var e="";e+="<ul class='ui-sug-wrapper'>";for(var i=0,r=Math.min(g,t.length);r>i;i++)e+="<li>"+t[i].t+"</li>";return e+="</ul>",e+=["<ul class='ui-sug-btns'>","<li class='ui-sug-close'>关闭</li>","</ul>"].join("")}function o(t,e){n.ajax({type:"get",url:p,data:{kw:t},dataType:"json",success:function(t){if(t&&0===t.errno&&t.data&&t.data.length>0){var i=s(t.data);e.html(i)}}})}var n=t("common:widget/lib/gmu/zepto/zepto.js"),a=t("common:widget/ui/usertrack/usertrack.js"),c=t("common:widget/ui/http/http.js"),u=t("common:widget/ui/storage/storage.js"),l="/webapp/tuan/list",p="/webapp/tuan/sug",g=7,h=function(t,e){if(e=e||l,""===t.trim())return a.location(e+"?"+c.reject("kw")),void 0;var i=u.getItem("search_history")||[];"[object Array]"!==Object.prototype.toString.call(i)&&(i=[]);var r=i.indexOf(t);r>-1&&i.splice(r,1),i.unshift(t),i.length>4&&(i=i.slice(0,4)),u.setItem("search_history",i,365),a.location(e+"?"+c.create({kw:t}))},m=function(t){t=n.extend({$input:"",$wrapper:"",hotbrand:[],baseURL:l},t);var e=null;t.$input.on("input focus",function(){var i=n(this).val();if(window.clearTimeout(e),""===i){var s=u.getItem("search_history")||[];"[object Array]"!==Object.prototype.toString.call(s)&&(s=[]),r(t.hotbrand,s,t.$wrapper)}else e=window.setTimeout(function(){o(i,t.$wrapper)},300)}),t.$wrapper.on("click",".ui-sug-hotbrand li",function(){var e=n(this).text();t.$wrapper.html(""),a.send("action=search&type=hotword&query="+e+"&content="+e),h(e,t.baseURL)}),t.$wrapper.on("click",".ui-sug-history li",function(){var e=n(this).text();t.$wrapper.html(""),a.send("action=search&type=history&query="+e+"&content="+e),h(e,t.baseURL)}),t.$wrapper.on("click",".ui-sug-wrapper li",function(){var e=n(this).text();t.$wrapper.html(""),a.send("action=search&type=suggestion&query="+e+"&content="+e),h(e,t.baseURL)}),t.$wrapper.on("click",".ui-sug-clear",function(){u.removeItem("search_history"),a.send("action=search&type=clearHistory"),t.$wrapper.find(".ui-sug-history").remove()}),t.$wrapper.on("click",".ui-sug-close",function(){a.send("action=search&type=closeSug"),t.$wrapper.html(""),"function"==typeof t.onclose&&t.onclose()}),t.$wrapper.on("click",".ui-sug-close-small",function(){a.send("action=search&type=closeSug"),t.$wrapper.html(""),"function"==typeof t.onclose&&t.onclose()})};i.exports={search:h,suggest:m}});
;define("common:widget/ui/geolocation/geolocation.js",function(o,t,n){o("common:widget/ui/map_geolocation/map_geolocation.js");var e=o("common:widget/lib/gmu/zepto/zepto.js");n.exports.getPosition=function(o,t,n){function i(t){var n=t.addressComponent.cityCode,i="/webapp/common/ajax",c={method:"getCityByCityCode",filtercnt:1,citycode:n};e.getJSON(i,c,function(n){0==n.errno?n.data?o(n.data,t):o(null,t):o(null,t)})}function c(o){o.html5Error=o.html5Error||{},t(o)}window.geolocation.getCurrentPosition(i,c,n)}});
;var $=require("common:widget/lib/gmu/zepto/zepto.js"),Storage=require("common:widget/ui/storage/storage.js"),Cookie=require("common:widget/ui/cookie/cookie.js"),geo=require("common:widget/ui/geolocation/geolocation.js"),usertrack=require("common:widget/ui/usertrack/usertrack.js"),http=require("common:widget/ui/http/http.js");$(function(){function t(){i(),e()}function e(){$("#Submit").on("tap",function(){var t=$.trim($("#SearchInput").val()),e="",i={kw:t};$.getJSON(e,i,function(t){var e=t.data.citysearch;if(e instanceof Array&&e.length>0)for(var i=0,o=e.length;o>i;i++){e[i]}})}),$(".letters .letter").on("tap",function(){var t=$(this);if(t.hasClass("letter-active"))return!1;var e=t.html(),i=$("#Letters"),o=$(".letter",i),a=i.data("oldselectedno"),r=i.data("oldselectedletter"),c=$("#LetterDetail_"+e),n=$("#LetterDetail_"+r),s=t.width(),l=i.width(),d=parseInt(l/s),u=o.index(t)+1,h=Math.ceil(u/d),f=d*h,m=o.size();f=f>m?m:f;var g=o.eq(f-1),p=t.position().left,v=$("div:first-child",c),j=p+s/2-2-10;a&&o.eq(a-1).removeClass("letter-active"),t.addClass("letter-active"),i.data("oldselectedno",u),i.data("oldselectedletter",e),n.hide(),c.show().insertAfter(g),v.css("left",j),$("#j-more").get(0).scrollIntoView(!0)}),$("#j-p-city").on("tap","a",function(){var t=$(this),e=t.data("id");if(e){Cookie.set("areaCode",e),Storage.setItem("IS_USER_SELECT_CITY","1",1);var i=t.attr("backup-href")+"?changeCity="+e;usertrack.location(i)}})}function i(){function t(t){if(usertrack.send({position:"city",action:"locate",type:"success",content:""}),!t)return $("#j-locating").hide(),$("#j-locate-fail").html("该城市没有团购，请选择其他城市").show(),void 0;var e=(t.domainUrl,t.shortName),i=t.areaId,o=F.context("citySelectReturnUrl"),a=['<div class="city-wrap">','<a href="javascript:;" backup-href="'+o+'" data-id="'+i+'">'+e+"</a>","</div>"];$("#j-locate-wrap").html(a.join(""))}function e(t){$("#j-locating").hide(),$("#j-locate-fail").html("暂时无法定位，请手动选择城市").show(),usertrack.send({position:"city",action:"locate",type:"failure",content:t.html5Error.code})}var i={};usertrack.send({position:"city",action:"locate",type:"all",content:""}),geo.getPosition(t,e,i)}t()});